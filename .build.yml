---

image: archlinux

packages:
  - hugo
  - hut

oauth: pages.sr.ht/PAGES:RW

secrets:
  - 4105c56c-96a3-428e-8a0a-8db6a73ffe28

environment:
  site: blog.karolak.fr

tasks:
  - build: >
      set +x ;
      . ~/.secrets ;
      set -x ;
      cd blog/ ;
      hugo --gc --minify ;
  - publish: >
      tar -C blog/public/ -cvz . > site.tar.gz ;
      hut pages publish -d $site site.tar.gz ;
